[gd_scene load_steps=6 format=2]

[ext_resource path="res://Main.tscn" type="PackedScene" id=1]
[ext_resource path="res://Construct.gd" type="Script" id=2]

[sub_resource type="Shader" id=1]
code = "shader_type canvas_item;

void fragment() {
	vec4 color = texture(TEXTURE, UV);

	// regular Linear -> SRGB conversion
	vec3 a = vec3(0.055);
	color.rgb = mix((vec3(1.0) + a) * pow(color.rgb, vec3(1.0 / 2.4)) - a, 12.92 * color.rgb, lessThan(color.rgb, vec3(0.0031308)));

	color.a = 1.0;
	COLOR = color;
}
"

[sub_resource type="ShaderMaterial" id=2]
shader = SubResource( 1 )

[sub_resource type="ViewportTexture" id=3]
viewport_path = NodePath("HMDViewport")

[node name="Construct" type="Node"]
script = ExtResource( 2 )

[node name="HMDViewport" type="Viewport" parent="."]
size = Vector2( 500, 500 )
render_target_update_mode = 3
shadow_atlas_size = 4096

[node name="Main" parent="HMDViewport" instance=ExtResource( 1 )]

[node name="FPController" parent="HMDViewport/Main" index="2"]
viewport = NodePath("../..")

[node name="Skeleton" parent="HMDViewport/Main/FPController/LeftHand/HandModel/Armature001" index="0"]
bones/9/bound_children = [ NodePath("IndexTip") ]

[node name="IndexTip" parent="HMDViewport/Main/FPController/LeftHand/HandModel/Armature001/Skeleton" index="1"]
transform = Transform( 0.19221, -0.669965, -0.717079, 0.977075, 0.19881, 0.076153, 0.0915428, -0.715277, 0.692819, 0.0345973, 0.0355402, -0.164767 )

[node name="Skeleton" parent="HMDViewport/Main/FPController/RightHand/HandModel/Armature" index="0"]
bones/9/bound_children = [ NodePath("IndexTip") ]

[node name="IndexTip" parent="HMDViewport/Main/FPController/RightHand/HandModel/Armature/Skeleton" index="1"]
transform = Transform( 0.19221, 0.669966, 0.717078, -0.091543, -0.715277, 0.69282, 0.977075, -0.19881, -0.0761527, -0.0345978, -0.164767, -0.0355401 )

[node name="HMDPreview" type="TextureRect" parent="."]
material = SubResource( 2 )
margin_left = 12.0
margin_top = 8.0
margin_right = 664.0
margin_bottom = 543.0
texture = SubResource( 3 )
expand = true
stretch_mode = 1
flip_v = true

[connection signal="initialised" from="HMDViewport/Main/FPController" to="." method="_on_FPController_initialised"]

[editable path="HMDViewport/Main"]
[editable path="HMDViewport/Main/FPController"]
[editable path="HMDViewport/Main/FPController/LeftHand"]
[editable path="HMDViewport/Main/FPController/LeftHand/HandModel"]
[editable path="HMDViewport/Main/FPController/RightHand"]
[editable path="HMDViewport/Main/FPController/RightHand/HandModel"]
